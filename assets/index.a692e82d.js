import{d as L,r as d,v as C,c as r,f as V,w as e,_ as N,e as h,i as T,h as s,j as p,P as q,M as x,a as E,x as K,Q as j,g as S,U as M,m as y,F as $,y as z,t as P,k as B,p as G,l as H}from"./index.88332f36.js";import{_ as Q}from"./deepeye-logo.736eea97.js";import{d as D}from"./format.b40c70ff.js";const J={username:{title:"Username",content:"deepeye"},role:{title:"Role / Level",content:"0"},registerAt:{title:"Register At",content:"2023-12-01"}},W=[{title:"IP",align:"left",ellipsis:!0,colKey:"loginIp",width:200},{title:"Region",align:"left",ellipsis:!0,colKey:"region",width:300},{title:"Time",align:"center",colKey:"createdAt",width:200}],X=L({__name:"DialogForm",props:{visible:{type:Boolean,default:!1},data:{type:Object,default:()=>({})}},emits:["update:visible"],setup(_,{emit:I}){const m={oldPass:"",newPass:""},f=_,u=d(!1),a=d(f.data),k=async({validateResult:l,firstError:o})=>{if(o)console.log("Errors: ",l),x.warning(o);else{try{await q(a.value.oldPass,a.value.newPass),x.success("Reset success")}catch(t){x.error(t.message)}u.value=!1}},U=()=>{u.value=!1,a.value={...m}},R=I;C(()=>u.value,l=>{R("update:visible",l)}),C(()=>f.visible,l=>{u.value=l}),C(()=>f.data,l=>{a.value=l});const w={oldPass:[{required:!0,message:"Old password is required",type:"error"}],newPass:[{required:!0,message:"New password is required",type:"error"}]};return(l,o)=>{const t=r("t-input"),i=r("t-form-item"),g=r("t-button"),v=r("t-form"),b=r("t-dialog");return h(),V(b,{visible:u.value,"onUpdate:visible":o[2]||(o[2]=c=>u.value=c),header:"ResetPass",width:580,footer:!1},{body:e(()=>[T(" \u8868\u5355\u5185\u5BB9 "),s(v,{ref:"form",data:a.value,rules:w,"label-width":150,onSubmit:k},{default:e(()=>[s(i,{label:"Old Password",name:"oldPass"},{default:e(()=>[s(t,{modelValue:a.value.oldPass,"onUpdate:modelValue":o[0]||(o[0]=c=>a.value.oldPass=c),style:{width:"380px"},placeholder:"Please input old password"},null,8,["modelValue"])]),_:1}),s(i,{label:"New Password",name:"newPass"},{default:e(()=>[s(t,{modelValue:a.value.newPass,"onUpdate:modelValue":o[1]||(o[1]=c=>a.value.newPass=c),style:{width:"380px"},placeholder:"Please input new password"},null,8,["modelValue"])]),_:1}),s(i,{style:{float:"right"}},{default:e(()=>[s(g,{variant:"outline",onClick:U},{default:e(()=>[p("Cancel")]),_:1}),s(g,{theme:"primary",type:"submit"},{default:e(()=>[p("Submit")]),_:1})]),_:1})]),_:1},8,["data"])]),_:1},8,["visible"])}}});var Y=N(X,[["__file","/Users/mbp13/git/deepeye/app-deepeye/src/pages/user/components/DialogForm.vue"]]);const F=_=>(G("data-v-4070cfdc"),_=_(),H(),_),Z={class:"user-left-greeting"},ee=F(()=>y("div",{class:"user-left-title"},"DeepEye User Center",-1)),te=F(()=>y("img",{src:Q,class:"logo"},null,-1)),se={class:"contract-title"},ae={class:"contract-detail",style:{display:"flex","align-items":"center"}},oe={name:"UserIndex"},le=L({...oe,setup(_){const I=E(),m=d(J);d([]);const f=d([]),u=!1,a=d(!1),k=d({}),U=async()=>{try{const t=await M();m.value.username.content=t.user.username,m.value.role.content=R(t.user.role),m.value.registerAt.content=D(t.user.registerAt),f.value=t.loginHistory}catch(t){console.log("e: ",t),t.response.status===401?w():x.error(t.message)}};function R(t){return t==1?"PRO":t==2?"VIP":"BASIC"}K(()=>{j().token||w(),U()});function w(){const t="/login";I.push(t)}function l(){}const o=async()=>{w()};return(t,i)=>{const g=r("t-button"),v=r("t-col"),b=r("t-row"),c=r("t-card"),O=r("t-table");return h(),S("div",null,[s(b,{gutter:[24,24]},{default:e(()=>[s(v,{flex:3},{default:e(()=>[y("div",Z,[s(v,{flex:3},{default:e(()=>[ee,s(g,{theme:"primary",shape:"round",type:"submit",onClick:o},{default:e(()=>[p(" Logout ")]),_:1}),s(g,{theme:"primary",shape:"round",onClick:i[0]||(i[0]=n=>a.value=!0)},{default:e(()=>[p(" Reset Password ")]),_:1})]),_:1}),s(v,{flex:1},{default:e(()=>[te]),_:1})]),s(c,{class:"user-info-list",title:"Basic Info"},{default:e(()=>[s(b,{class:"content",justify:"space-between"},{default:e(()=>[(h(!0),S($,null,z(m.value,(n,A)=>(h(),V(v,{key:A,class:"contract"},{default:e(()=>[y("div",se,P(n.title),1),y("div",ae,[p(P(n.content)+" ",1),A=="role"&&n.content!="VIP"?(h(),V(g,{key:0,style:{margin:"auto","margin-left":"16px"},theme:"primary",shape:"rectangle",size:"small",onClick:l,disabled:u},{default:e(()=>[p(" Upgrade ")]),_:1})):T("v-if",!0)])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),s(Y,{visible:a.value,"onUpdate:visible":i[1]||(i[1]=n=>a.value=n),data:k.value},null,8,["visible","data"]),s(b,{gutter:16,class:"row-container"},{default:e(()=>[s(c,{title:"Recent Login Records",class:"dashboard-rank-card",bordered:!1},{actions:e(()=>[]),default:e(()=>[s(O,{data:f.value,columns:B(W),"row-key":"colKey"},{createdAt:e(({row:n})=>[p(P(B(D)(n.createdAt)),1)]),region:e(({row:n})=>[y("span",null,P(n.loginLocation),1)]),_:1},8,["data","columns"])]),_:1})]),_:1})])}}});var ue=N(le,[["__scopeId","data-v-4070cfdc"],["__file","/Users/mbp13/git/deepeye/app-deepeye/src/pages/user/index.vue"]]);export{ue as default};
